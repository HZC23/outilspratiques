<!DOCTYPE html>
<div class="tool-container" id="styletextTool">
    
    <div class="tool-header">
        <h2><i class="fas fa-feather-alt"></i> Styliseur de texte</h2>
        <div class="tool-actions">
            <button type="button" class="btn-icon" id="styletextHelp" aria-label="Aide">
                <i class="fas fa-question-circle"></i>
            </button>
            <button type="button" class="btn-icon" id="fullscreenBtn" aria-label="Plein Ã©cran">
                <i class="fas fa-expand"></i>
            </button>
        </div>
    </div>
    
    <div class="tool-content">
        <div class="styletext-main-container">
            <div class="styletext-io-container">
                <div class="input-section">
                    <textarea id="inputText" placeholder="Saisissez ou collez votre texte ici..." class="styletext-textarea"></textarea>
                    <div class="text-controls">
                        <div class="character-count">
                            <span id="inputCounter">0</span> caractÃ¨res
                        </div>
                        <div class="buttons-group">
                            <button type="button" class="control-btn" id="clearText">
                                <i class="fas fa-times"></i> Effacer
                            </button>
                            <button type="button" class="control-btn" id="pasteText">
                                <i class="fas fa-paste"></i> Coller
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="output-section">
                    <textarea id="outputText" readonly class="styletext-output"></textarea>
                    <div class="output-controls">
                        <button type="button" class="primary-btn" id="copyButton">
                            <i class="fas fa-copy"></i> Copier dans le Presse-papiers
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="styles-section">
                <h3 class="styles-title">SÃ©lectionnez un style</h3>
                <div class="style-options-grid">
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="normal" checked>
                        <div class="style-content">
                            <span class="style-preview">Abc</span>
                            <span class="style-name">Normal</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="outline">
                        <div class="style-content">
                            <span class="style-preview">ğ•’ğ•“ğ•”</span>
                            <span class="style-name">Police de contour</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="squared">
                        <div class="style-content">
                            <span class="style-preview">ğŸ…ğŸ…‘ğŸ…’</span>
                            <span class="style-name">Texte carrÃ©</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="smallcaps">
                        <div class="style-content">
                            <span class="style-preview">á´€Ê™á´„</span>
                            <span class="style-name">Petites majuscules</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="bold">
                        <div class="style-content">
                            <span class="style-preview">ğ€ğ›ğœ</span>
                            <span class="style-name">Gras</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="fraktur">
                        <div class="style-content">
                            <span class="style-preview">ğ”„ğ”Ÿğ” </span>
                            <span class="style-name">Vieux texte anglais</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="flipped">
                        <div class="style-content">
                            <span class="style-preview">ÉqÉ”</span>
                            <span class="style-name">Texte Ã  l'envers</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="serif">
                        <div class="style-content">
                            <span class="style-preview">ğ€ğ›ğœ</span>
                            <span class="style-name">Police serif</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="script">
                        <div class="style-content">
                            <span class="style-preview">ğ“ğ“«ğ“¬</span>
                            <span class="style-name">Lettres cursives</span>
                        </div>
                    </label>
                    
                    <label class="style-option">
                        <input type="radio" name="textStyle" value="superscript">
                        <div class="style-content">
                            <span class="style-preview">á´¬áµ‡á¶œ</span>
                            <span class="style-name">Exposant</span>
                        </div>
                    </label>
                </div>
            </div>
        </div>
    </div>
    
    <div class="help-panel" id="styletextHelpPanel">
        <div class="help-panel-header">
            <h3>Aide - Styliseur de texte</h3>
            <button type="button" class="btn-icon" id="closeStyletextHelp">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="help-panel-content">
            <h4>Comment utiliser</h4>
            <ol>
                <li>Saisissez ou collez votre texte dans la zone "Texte Ã  styliser"</li>
                <li>SÃ©lectionnez un style parmi les options disponibles</li>
                <li>Le texte stylisÃ© apparaÃ®t automatiquement dans la zone de sortie</li>
                <li>Utilisez le bouton "Copier" pour copier le texte stylisÃ© dans le presse-papier</li>
            </ol>
            
            <h4>Styles disponibles</h4>
            <ul>
                <li><strong>Normal</strong> : Texte normal sans transformation</li>
                <li><strong>Police de contour</strong> : ğ•¡ğ• ğ•ğ•šğ•”ğ•– ğ••ğ•– ğ•”ğ• ğ•Ÿğ•¥ğ• ğ•¦ğ•£ - style double avec contour</li>
                <li><strong>Texte carrÃ©</strong> : ğŸ…£ğŸ…”ğŸ…§ğŸ…£ğŸ…” ğŸ…’ğŸ…ğŸ…¡ğŸ…¡ğŸ…” - lettres dans des carrÃ©s</li>
                <li><strong>Petites majuscules</strong> : á´˜á´‡á´›Éªá´›á´‡s á´á´€á´Šá´œsá´„á´œÊŸá´‡s - version rÃ©duite des majuscules</li>
                <li><strong>Gras</strong> : ğ†ğ«ğšğ¬ - caractÃ¨res en gras mathÃ©matique</li>
                <li><strong>Vieux texte anglais</strong> : ğ”³ğ”¦ğ”¢ğ”²ğ”µ ğ”±ğ”¢ğ”µğ”±ğ”¢ ğ”ğ”«ğ”¤ğ”©ğ”ğ”¦ğ”° - style mÃ©diÃ©val</li>
                <li><strong>Texte Ã  l'envers</strong> : Ê‡ÇxÊ‡Ç Ã  l,ÇuÊŒÇÉ¹s - texte retournÃ© Ã  180Â°</li>
                <li><strong>Police serif</strong> : ğ©ğ¨ğ¥ğ¢ğœğ ğ¬ğğ«ğ¢ğŸ - style avec empattements</li>
                <li><strong>Lettres cursives</strong> : ğ“µğ“®ğ“½ğ“½ğ“»ğ“®ğ“¼ ğ“¬ğ“¾ğ“»ğ“¼ğ“²ğ“¿ğ“®ğ“¼ - style d'Ã©criture Ã  la main</li>
                <li><strong>Exposant</strong> : áµ‰Ë£áµ–áµ’Ë¢áµƒâ¿áµ— - texte en petit au-dessus de la ligne</li>
            </ul>
            
            <h4>Raccourcis clavier</h4>
            <ul>
                <li><kbd>Ctrl</kbd> + <kbd>EntrÃ©e</kbd> : Convertir le texte</li>
                <li><kbd>Ã‰chap</kbd> : Fermer les fenÃªtres contextuelles</li>
                <li><kbd>Ctrl</kbd> + <kbd>C</kbd> : Copier le texte stylisÃ© lorsqu'il est sÃ©lectionnÃ©</li>
            </ul>
            
            <h4>Remarque</h4>
            <p>Certains styles utilisent des caractÃ¨res Unicode spÃ©ciaux qui peuvent ne pas s'afficher correctement sur tous les appareils. Ces caractÃ¨res sont principalement destinÃ©s aux rÃ©seaux sociaux et Ã  la messagerie instantanÃ©e, oÃ¹ leur prise en charge est gÃ©nÃ©ralement bonne.</p>
        </div>
    </div>
</div>

<script>
    // Script de dÃ©bogage pour le styliseur de texte
    document.addEventListener('DOMContentLoaded', function() {
        console.log('---- DÃ‰BOGAGE STYLETEXT ----');
        console.log('DOM chargÃ© - vÃ©rification des Ã©lÃ©ments critiques');
        
        // VÃ©rifier les onglets
        const tabs = document.querySelectorAll('.styletext-tab');
        console.log(`Nombre d'onglets trouvÃ©s : ${tabs.length}`);
        
        tabs.forEach((tab, index) => {
            console.log(`Onglet ${index + 1}: target=${tab.getAttribute('data-target')}, classe=${tab.className}`);
            
            // Ajouter un gestionnaire d'Ã©vÃ©nements robuste
            tab.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('data-target');
                console.log(`Clic sur onglet avec cible: ${targetId}`);
                
                // Retirer la classe active de tous les onglets
                tabs.forEach(t => t.classList.remove('active'));
                
                // Ajouter la classe active Ã  l'onglet cliquÃ©
                this.classList.add('active');
                
                // DÃ©sactiver tous les panneaux
                document.querySelectorAll('.tab-pane').forEach(pane => {
                    pane.classList.remove('active');
                    // Force la visibilitÃ© Ã  none
                    pane.style.display = 'none';
                    console.log(`Panneau dÃ©sactivÃ©: ${pane.id}`);
                });
                
                // Activer le panneau cible
                const targetPane = document.getElementById(targetId);
                if (targetPane) {
                    targetPane.classList.add('active');
                    // Force la visibilitÃ© Ã  block
                    targetPane.style.display = 'block';
                    console.log(`Panneau activÃ©: ${targetId}`);
                } else {
                    console.error(`Panneau cible introuvable: ${targetId}`);
                }
            });
        });
        
        // VÃ©rifier les panneaux
        const panes = document.querySelectorAll('.tab-pane');
        console.log(`Nombre de panneaux trouvÃ©s : ${panes.length}`);
        
        panes.forEach((pane, index) => {
            console.log(`Panneau ${index + 1}: id=${pane.id}, classe=${pane.className}, display=${getComputedStyle(pane).display}`);
        });
        
        // Force l'affichage du premier onglet aprÃ¨s un court dÃ©lai
        setTimeout(function() {
            const firstTab = document.querySelector('.styletext-tab');
            if (firstTab) {
                console.log('Activation forcÃ©e du premier onglet');
                firstTab.click();
            }
        }, 500);
        
        // Fonction pour s'assurer que le contenu des onglets est correctement initialisÃ©
        function initTabsPanels() {
            // Masquer tous les panneaux
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.style.display = 'none';
            });
            
            // Afficher uniquement le panneau actif
            const activeTab = document.querySelector('.styletext-tab.active');
            if (activeTab) {
                const targetId = activeTab.getAttribute('data-target');
                const targetPane = document.getElementById(targetId);
                if (targetPane) {
                    targetPane.style.display = 'block';
                    console.log(`Initialisation: panneau ${targetId} affichÃ©`);
                }
            }
        }
        
        // Initialiser les panneaux aprÃ¨s un court dÃ©lai
        setTimeout(initTabsPanels, 800);
    });
</script>

<!-- Script principal du styliseur -->
<script type="module">
    import { StyleTextManager, debugStyleText } from '/js/tools/styletext.js';
    
    // Initialiser le styliseur
    document.addEventListener('DOMContentLoaded', function() {
        StyleTextManager.init();
        
        // ExÃ©cuter le dÃ©bogage aprÃ¨s un court dÃ©lai
        setTimeout(function() {
            console.log('ExÃ©cution du dÃ©bogage depuis le module');
            if (typeof debugStyleText === 'function') {
                debugStyleText();
            } else {
                console.error('Fonction debugStyleText non disponible');
            }
        }, 1000);
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialiser l'aide et le bouton plein Ã©cran
        const helpBtn = document.getElementById('styletextHelp');
        const closeHelpBtn = document.getElementById('closeStyletextHelp');
        const helpPanel = document.getElementById('styletextHelpPanel');
        
        if (helpBtn && helpPanel && closeHelpBtn) {
            helpBtn.addEventListener('click', function() {
                helpPanel.classList.add('active');
            });
            
            closeHelpBtn.addEventListener('click', function() {
                helpPanel.classList.remove('active');
            });
        }
        
        // Bouton pour effacer l'historique
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        if (clearHistoryBtn) {
            clearHistoryBtn.addEventListener('click', function() {
                localStorage.removeItem('styletextHistory');
                renderHistory();
                showToast('Historique effacÃ©', 'info');
            });
        }
        
        // Boutons pour effacer et coller
        const clearTextBtn = document.getElementById('clearText');
        const pasteTextBtn = document.getElementById('pasteText');
        const inputText = document.getElementById('inputText');
        
        if (clearTextBtn && inputText) {
            clearTextBtn.addEventListener('click', function() {
                inputText.value = '';
                inputText.focus();
                StyleTextManager.applyCurrentStyle();
                updateCharacterCount();
            });
        }
        
        if (pasteTextBtn && inputText) {
            pasteTextBtn.addEventListener('click', function() {
                navigator.clipboard.readText()
                    .then(text => {
                        inputText.value = text;
                        StyleTextManager.applyCurrentStyle();
                        updateCharacterCount();
                    })
                    .catch(err => {
                        console.error('Erreur de collage:', err);
                        alert('Impossible d\'accÃ©der au presse-papiers');
                    });
            });
        }
        
        // Compteur de caractÃ¨res
        function updateCharacterCount() {
            const counter = document.getElementById('inputCounter');
            if (counter && inputText) {
                counter.textContent = inputText.value.length;
            }
        }
        
        if (inputText) {
            inputText.addEventListener('input', updateCharacterCount);
            // Initialiser le compteur
            updateCharacterCount();
        }
    });
    
    // Fonction globale pour afficher un toast
    function showToast(message, type = 'info') {
        const toast = document.createElement('div');
        toast.className = `styletext-toast ${type}`;
        toast.textContent = message;
        
        document.body.appendChild(toast);
        
        // Animation d'entrÃ©e
        setTimeout(() => toast.classList.add('show'), 10);
        
        // Disparition aprÃ¨s 3 secondes
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }
</script>

<style>
:root {
    --primary-color: #4285f4;
    --primary-dark: #3367d6;
    --secondary-color: #34a853;
    --accent-color: #fbbc05;
    --danger-color: #ea4335;
    --text-color: #202124;
    --text-secondary: #5f6368;
    --bg-color: #ffffff;
    --bg-secondary: #f8f9fa;
    --border-color: #dadce0;
    --shadow-sm: 0 1px 2px rgba(60, 64, 67, 0.3);
    --shadow-md: 0 2px 6px rgba(60, 64, 67, 0.15);
    --shadow-lg: 0 4px 12px rgba(60, 64, 67, 0.2);
    --transition: all 0.2s ease;
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
}

.styletext-main-container {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem;
}

.styletext-io-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

@media (min-width: 768px) {
    .styletext-io-container {
        flex-direction: row;
    }
    
    .input-section, .output-section {
        flex: 1;
    }
}

.input-section, .output-section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.styletext-textarea, .styletext-output {
    width: 100%;
    min-height: 150px;
    padding: 1rem;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    font-size: 1rem;
    line-height: 1.5;
    resize: vertical;
    transition: var(--transition);
    background-color: var(--bg-color);
    color: var(--text-color);
}

.styletext-textarea:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
}

.styletext-output {
    background-color: var(--bg-secondary);
}

.text-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.character-count {
    font-size: 0.875rem;
    color: var(--text-secondary);
}

.buttons-group {
    display: flex;
    gap: 0.5rem;
}

.control-btn {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.375rem 0.75rem;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    background-color: var(--bg-color);
    color: var(--text-secondary);
    font-size: 0.875rem;
    cursor: pointer;
    transition: var(--transition);
}

.control-btn:hover {
    background-color: var(--bg-secondary);
    color: var(--text-color);
}

.primary-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border: none;
    border-radius: var(--radius-sm);
    background-color: var(--primary-color);
    color: white;
    font-weight: 500;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--shadow-sm);
}

.primary-btn:hover {
    background-color: var(--primary-dark);
    box-shadow: var(--shadow-md);
}

.output-controls {
    display: flex;
    justify-content: flex-end;
}

.styles-title {
    font-size: 1.25rem;
    font-weight: 500;
    color: var(--text-color);
    margin-bottom: 1rem;
    text-align: center;
}

.style-options-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 1rem;
}

.style-option {
    position: relative;
    cursor: pointer;
}

.style-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
}

.style-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    border: 2px solid var(--border-color);
    border-radius: var(--radius-md);
    background-color: var(--bg-color);
    transition: var(--transition);
    height: 100%;
    min-height: 100px;
}

.style-option:hover .style-content {
    border-color: var(--primary-color);
    box-shadow: var(--shadow-sm);
}

.style-option input[type="radio"]:checked + .style-content {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.3);
    background-color: rgba(66, 133, 244, 0.05);
}

.style-preview {
    font-size: 1.5rem;
    margin-bottom: 0.75rem;
    min-height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.style-name {
    font-size: 0.875rem;
    text-align: center;
    color: var(--text-color);
}

/* Animation lors du changement de style */
@keyframes highlight {
    0% { background-color: var(--bg-secondary); }
    50% { background-color: rgba(66, 133, 244, 0.1); }
    100% { background-color: var(--bg-secondary); }
}

.style-changed {
    animation: highlight 0.5s ease;
}
</style> 